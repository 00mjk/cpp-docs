---
title: ".vcxproj and .props file structure | Microsoft Docs"
ms.custom: ""
ms.date: "04/27/2017"
ms.reviewer: ""
ms.suite: ""
ms.technology: 
  - "devlang-cpp"
ms.tgt_pltfrm: ""
ms.topic: "article"
dev_langs: 
  - "C++"
helpviewer_keywords: 
  - ".vcxproj file structure"
ms.assetid: 14d0c552-29db-480e-80c1-7ea89d6d8e9c
caps.latest.revision: 1
author: "mikeblome"
ms.author: "mblome"
manager: "ghogen"
translation.priority.ht: 
  - "cs-cz"
  - "de-de"
  - "es-es"
  - "fr-fr"
  - "it-it"
  - "ja-jp"
  - "ko-kr"
  - "pl-pl"
  - "pt-br"
  - "ru-ru"
  - "tr-tr"
  - "zh-cn"
  - "zh-tw"
---

# .vcxproj and .props file structure
MSBuild is the default project system in Visual Studio; when you choose **File | New Project** in Visual C++ you are creating an MSBuild project whose settings are stored in an XML project file that has the extension `.vcxproj`. The project file may also import .props files and .targets files where settings can be stored. In most cases, you never need to manually edit the project file, and in fact you should not edit it manually unless you have a good understanding of MSBuild. Whenever possible you should use the Visual Studio property pages to modify project settings. However, in some cases you may need to modify a project file or property sheet manually. For those scenarios, this article contains basic information about the structure of the file. 

**Important:**
If you choose to manually edit a .vcxproj file, be aware of these facts:
1. The structure of the file must follow a prescribed form. For more information, see [A guide to .vcxproj and .props file structure]((https://blogs.msdn.microsoft.com/visualstudio/2010/05/14/a-guide-to-vcxproj-and-props-file-structure/)).
2. Visual Studio does not support wildcards in CICompile includes properties. For example, this is not supported:
```xaml
<ClCompile Include="*.cpp"/>
```
3. Visual Studio does not support macros in project item paths. For example, this is not supported:
```xaml
<ClCompile Include="$(IntDir)\generated.cpp"/>
```

## .vcxproj file elements
You can inspect the contents of a .vcxproj file by using any text or XML editor. You can view it in Visual Studio by right-clicking on the project in Solution Explorer, choosing **Unload project** and then choosing **Edit Foo.vcxproj**. 

The first thing to notice is that the top-level elements appear in a particular order. For example:
-  most of the property groups and item definition groups occur after the import for Microsoft.Cpp.Default.props.
-  all targets are imported at the end of the file.
-  there are multiple property groups, each with a unique label, and they occur in a particular order.

The order of elements in the project file is very important, because MSBuild is based on a sequential evaluation model.  If your project file, including all the imported .props and .targets files, consists of multiple definitions of a property, the last definition overrides the preceding ones. In the following example, the value "xyz” will be set during compilation because the MSBUild engine encounters it last during its evaluation. 

```xaml 
 <MyProperty>abc</MyProperty>
 <MyProperty>xyz</MyProperty>
``` 
 
The following snippet shows a minimal .vcxproj file. Any .vcxproj file generated by Visual Studio will contain these top-level MSBuild elements and they will appear in this order (although they may contain multiple copies of each such top-level element). Note that Label attributes are arbitrary tags that are only used by Visual Studio as signposts for editing; they have no other function.

```xaml
<Project DefaultTargets="Build" ToolsVersion="4.0" xmlns='http://schemas.microsoft.com/developer/msbuild/2003'>
   <ItemGroup Label="ProjectConfigurations" />
   <PropertyGroup Label="Globals" />
   <Import Project="$(VCTargetsPath)\Microsoft.Cpp.default.props" />
   <PropertyGroup Label="Configuration" />
   <Import Project="$(VCTargetsPath)\Microsoft.Cpp.props" />
   <ImportGroup Label="ExtensionSettings" />
   <ImportGroup Label="PropertySheets" />
   <PropertyGroup Label="UserMacros" />
   <PropertyGroup />
   <ItemDefinitionGroup />
   <ItemGroup />
   <Import Project="$(VCTargetsPath)\Microsoft.Cpp.targets" />
   <ImportGroup Label="ExtensionTargets" />
 </Project>
```
 
 The following section describes the purpose of each of these elements and why they are ordered this way:
  
```xaml  
<Project DefaultTargets="Build" ToolsVersion="4.0" xmlns='http://schemas.microsoft.com/developer/msbuild/2003' >
```
`Project` is the root node. It specifies the MSBuild version to use and also the default target to be executed when this file is passed to MSBuild.exe.

```xaml  
<ItemGroup Label="ProjectConfigurations" />
```
`ProjectConfigurations` contains the project configurations which specify a debug or release build and the platform. Examples are Debug|Win32, Release|Win32, Debug|ARM and so on. Many project settings are specific to a given configuration. For example, you will probably want to set optimization properties for a release build but not a debug build.  

 ```xaml  
 <PropertyGroup Label="" />
```
 `Globals` contains project level settings such as ProjectGuid, RootNamespace, etc. These properties are typically not overridden elsewhere in the project file. This group is not configuration-dependent and therefore typically only one Globals group exists in the project file.

```xaml
 <Import Project="$(VCTargetsPath)\Microsoft.Cpp.default.props" />
```

The **Microsoft.Cpp.default.props** property sheet comes with Visual Studio and cannot be modified. It contains the default settings for a Visual C++ project. It contains definitions of all the project settings such as Platform, PlatformToolset, OutputPath, TargetName, UseOfAtl, etc. It also contains all the item definition group defaults for each known item group. In general, properties in this file are not tool-specific.

```xaml
<PropertyGroup Label="Configuration" />
```
 The `Configuration` property group has an attached configuration condition (such as `Condition=”'$(Configuration)|$(Platform)'=='Debug|Win32'”`) and comes in multiple copies, one per configuration. This property group hosts the properties that are set for a specific configuration. These properties control the inclusion of system property sheets in **Microsoft.Cpp.props**. For example, if you define the property `<CharacterSet>Unicode</CharacterSet>`, then the system property sheet **microsoft.Cpp.unicodesupport.props** will be included. If you inspect **Microsoft.Cpp.props**, you will see the line:
`<Import Condition=”'$(CharacterSet)' == 'Unicode'”   Project=”$(VCTargetsPath)\microsoft.Cpp.unicodesupport.props”/>`. 

```xaml
<Import Project="$(VCTargetsPath)\Microsoft.Cpp.props" />
```
The **Microsoft.Cpp.props** property sheet (directly or via imports) defines the default values for many tool-specific properties such as the compiler's Optimization and Warning Level properties, the MIDL tool's TypeLibraryName property, and so on. It also imports various system property sheets based on which configuration properties are defined in the property group immediately above. 

```xaml
<ImportGroup Label="ExtensionSettings" />
```
The `ExtensionSettings` group contains imports for the property sheets that are part of Build Customizations. A Build Customization is defined by up to three files: a .targets file, a .props file and an .xml file. This import group contains the imports for the .props file.

```xaml
<ImportGroup Label="PropertySheets" />
```
 The `PropertySheets` group contains the imports for user property sheets. These are the property sheets that you add through the Property Manager view in Visual Studio. The order in which these imports are listed is important and is reflected in the Property Manager. The project file normally contains multiple instances of this kind of import group, one for each project configuration.  
   
```xaml   
<PropertyGroup Label="UserMacros" />
```
`UserMacros` are as variables that are used to customize your build process. For example, you can define a user macro to define your custom output path as $(CustomOutputPath) and use it to define other variables. This property group houses such properties. Note that in Visual Studio, this group is not populated in the project file because Visual C++ does not support user macros for configurations. User macros are supported in property sheets. 

```xaml
<PropertyGroup />
``` 
 This property group normally comes with a configuration condition attached. You will also see multiple instances of the property group, one per configuration. Unlike the property groups above, this one does not have a label. This group contains project configuration-level settings. These settings apply to all files that are part of the specified item group. Build Customization item definition metadata is initialized here. 

 ```xaml
 <ItemDefinitionGroup />
 ```
An item is a file that is processed during the build; it might be a .h or .cpp file, an image, a data file, an IDL file or any other kind of file that you include in the project. The ItemDefinitionGroup contains item definitions and item definition metadata instead of properties.

```xaml
<ItemGroup />
```  
Contains the items (source files, etc.) in the project. You will generally have multiple item groups, one per item type. 
   
```xaml
<Import Project="$(VCTargetsPath)\Microsoft.Cpp.targets" />
```
Defines (directly or via imports) Visual C++ targets such as build, clean, etc.

```xaml
<ImportGroup Label="ExtensionTargets" />
```
This group contains imports for the Build Customization target files.
 
 ## Impact of incorrect ordering
 The Visual Studio IDE depends on the project file having the ordering described above. For example, when you define a property value in the property pages, the IDE will generally place the property definition in the property group with the empty label. This ensures that default values brought in the system property sheets are overridden by user defined values. Similarly, the target files are imported at the end since they consume the properties defined above and since they generally do not define properties themselves. Likewise, user property sheets are imported after the system property sheets (included via **Microsoft.Cpp.props**). This ensures that the user can override any defaults brought in by the system property sheets.
  
 If a .vcxproj file does not follow this layout, the build results may not be what you expect. For example, if you mistakenly import a system property sheet after the property sheets defined by the user, the user settings will be overridden by the system property sheets.
  
 Even the IDE design time experience depends to some extent on correct ordering of elements. For example, if your .vcxproj file does not have the `PropertySheets` import group, the IDE might not be able to determine where to place a new property sheet that the user has created in **Property Manager**. This could result in a user sheet being overriden by a system sheet. Although the heuristic used by IDE can tolerate minor inconsistencies in the .vcxproj file layout, it is strongly recommended not to deviate from the structure shown earlier in this article.

## How the IDE uses element labels
  
In the IDE, when you set the UseOfAtl property in the general property page, it is written to the Configuration property group in the project file, while the TargetName property in the same property page is written to the label-less property group. Visual Studio looks at the property page's xml file for the information on where to write each property. For the General property page, that file is `%ProgramFiles(x86)%\Microsoft Visual Studio\2017\Enterprise\Common7\IDE\VC\VCTargets\1033\general.xml`. The property page XML file defines the static information about a Rule and all its properties. One such piece of information is the preferred position of a Rule property in the destination file (the file where its value will be written). The preferred position is specified by the Label attribute on the project file elements. 


 ## Property Sheet layout
  
 The following XAML snippet is a minimal layout of a property sheet (.props) file. It is similar to a .vcxproj file, and the functionality of the .props elements can be inferred from the earlier discussion. 

```xaml
 <Project ToolsVersion="4.0" xmlns="http://schemas.microsoft.com/developer/msbuild/2003">
   <ImportGroup Label="PropertySheets" />
   <PropertyGroup Label="UserMacros" />
   <PropertyGroup />
   <ItemDefinitionGroup />
   <ItemGroup />
 </Project>
```
To make your own property sheet, copy one of the .props files in the VCTargets folder and modify it for your purposes. For Visual Studio 2017 Enterprise edition, the default VCTargets path is `%ProgramFiles%\Microsoft Visual Studio\2017\Enterprise\Common7\IDE\VC\VCTargets`. 

## See Also
[Working with Project Properties](working-with-project-properties.md)
[Property Page XML Files](property-page-xml-files.md)