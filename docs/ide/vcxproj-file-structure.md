You can inspect the contents of a .vcxproj file by using any text or XML editor. You can view it in Visual Studio by right-clicking on the project in Solution Explorer, choosing **Unload project** and then choosing **Edit Foo.vcxproj**. 
When you inspect a .vcxproj file, you see that the various top-level MSBuild elements are laid out in a particular order. For example:
-  most of the property groups and item definition groups occur after the import for Microsoft.Cpp.Default.props.
-  all targets are imported at the end of the file.
-  there are multiple property groups, each with a unique label, and they occur in a particular order.

 The order of elements in the project file is very important, because MSBuild is based on a sequential evaluation model.  If your project file, including all the imported .props and .targets files, consists of multiple definitions of a property, the last definition overrides the preceding ones. In the following example, the value “xyz” will be used during build time. 

 ```xaml 
 <MyProperty>abc</MyProperty>
 <MyProperty>xyz</MyProperty>
 ``` 
 
The following minimal .vcxproj file demonstrates the layout succinctly. Any .vcxproj file generated by VS will contain these top-level MSBuild elements and they will appear in this order (although they may contain multiple copies of each such top-level element). Note that Label attributes are arbitrary tags that are only used by Visual Studio and as signposts for editing; they have no other function.

```xaml
<Project DefaultTargets=“Build“ ToolsVersion=“4.0“ xmlns=‘http://schemas.microsoft.com/developer/msbuild/2003‘>
   <ItemGroup Label=“ProjectConfigurations“ />
   <PropertyGroup Label=“Globals“ />
   <Import Project=“$(VCTargetsPath)\Microsoft.Cpp.default.props“ />
   <PropertyGroup Label=“Configuration“ />
   <Import Project=“$(VCTargetsPath)\Microsoft.Cpp.props“ />
   <ImportGroup Label=“ExtensionSettings“ />
   <ImportGroup Label=“PropertySheets“ />
   <PropertyGroup Label=“UserMacros“ />
   <PropertyGroup />
   <ItemDefinitionGroup />
   <ItemGroup />
   <Import Project=“$(VCTargetsPath)\Microsoft.Cpp.targets“ />
   <ImportGroup Label=“ExtensionTargets“ />
 </Project>
```
 
 The following section describes the purpose of each of these elements and why they are ordered this way:
  
```xaml  
<Project DefaultTargets=“Build“ ToolsVersion=“4.0“ xmlns=‘http://schemas.microsoft.com/developer/msbuild/2003‘ >
```
`Project` is the root node. It specifies the MSBuild version to use and also the default target to be executed when this file is passed to MSBuild.exe.

```xaml  
<ItemGroup Label=“ProjectConfigurations“ />
```
This contains the project configurations known to the project (such as Debug|Win32 and Release|Win32).

 ```xaml  
 <PropertyGroup Label=“Globals“ />
```
This contains project level settings such as ProjectGuid, RootNamespace, etc. These properties are not typically overridden elsewhere in the project file. This group is not configuration-dependent and therefore typically only one Globals group exists in the project file.

```xaml
 <Import Project=“$(VCTargetsPath)\Microsoft.Cpp.default.props“ />
```

This property sheet contains the default settings for a Visual C++ project. It contains definitions of all the project settings such as Platform, PlatformToolset, OutputPath, TargetName, UseOfAtl, etc. It also contains all the item definition group defaults for each known item group. In general, properties in this file are not tool-specific.

```xaml
<PropertyGroup Label=“Configuration“ />
```
 This property group has an attached configuration condition (such as `Condition=”‘$(Configuration)|$(Platform)’==’Debug|Win32′”`)
   and comes in multiple copies, one per configuration. This property group hosts configuration-wide properties. These properties control the inclusion of system property sheets in Microsoft.Cpp.props. For example, if we define the property `<CharacterSet>Unicode</CharacterSet>`, then the system property sheet microsoft.Cpp.unicodesupport.props will be included (as can be seen in the Property Manager). IF you inspect Microsoft.Cpp.props, you will see the line:
`<Import Condition=”‘$(CharacterSet)’ == ‘Unicode'”   Project=”$(VCTargetsPath)\microsoft.Cpp.unicodesupport.props”/>`. 

```xaml
<Import Project=“$(VCTargetsPath)\Microsoft.Cpp.props“ />
```
This property sheet (directly or via imports) defines the default values for many tool-specific properties such as the compiler’s Optimization, WarningLevel properties, the MIDL tool’s TypeLibraryName property, and so on. It also imports various system property sheets based on which configuration properties are defined in the property group immediately above. 

```xaml
<ImportGroup Label=“ExtensionSettings“ />
```
This group contains imports for the property sheets that are part of Build Customizations. A Build Customization is defined by up to three files: a .targets file, a .props file and and .xml file. This import group contains the imports for the .props file.

```xaml
<ImportGroup Label=“PropertySheets“ />
```
 This group contains the imports for user property sheets. These are the property sheets that you add through the Property Manager view in Visual Studio. The order in which these imports are listed is relevant and is reflected in the Property Manager. The project file normally contains multiple instances of this kind of import group, one for each project configuration.  
   
```xaml   
<PropertyGroup Label=“UserMacros“ />
```
`UserMacros` are as variables that are used to customize your build process. For example, you can define a user macro to define your custom output path as $(CustomOutpuPath) and use it to define other variables. This property group houses such properties. Note that in VS2010, this group is not populated by the IDE since we do not support user macros for configurations (we do for property sheets though). 

```xaml
<PropertyGroup />
``` 
 This property group normally comes with a configuration condition attached. You will also see multiple instances of the property group, one per configuration. Unlike the property groups above, this one does not have a label. This group contains project configuration-level settings. These settings apply to all files that are part of the specified item group. Build Customization item definition metadata also gets initialized here. 

 ```xaml
 <ItemDefinitionGroup />
 ```
Similar to the property group immediately above, but it contains item definitions and item definition metadata instead of properties.

```xaml
<ItemGroup />
```  
Contains the items (source files, etc.) in the project. You will generally have multiple item groups, one per item type. 
   
```xaml
<Import Project=“$(VCTargetsPath)\Microsoft.Cpp.targets“ />
```
Defines (directly or via imports) VC++ targets such as build, clean, etc.

```xaml
<ImportGroup Label=“ExtensionTargets“ />
```
This group contains imports for the Build Customization target files.
 
 The above ordering ensures that editing the project file via that IDE gives expected results. For example, when you define a property value in the property pages, the IDE will generally place the property definition in the property group with the empty label. This ensures that default values brought in the system property sheets are overridden by user defined values. Similarly, the target files are imported at the end since they consume the properties defined above and since they generally do not define properties themselves. Likewise, user property sheets are imported after the system property sheets (included via Microsoft.Cpp.props). This ensures that the user can override any defaults brought in by the system property sheets.
  
 If a .vcxproj file does not follow this layout, the build results may not be like you expected. For example, properties that are defined by the user using property pages may not be used during the build since they could have been overridden by the system property sheets in this different layout.
  
 Even the IDE design time experience may suffer, although VS does its best to work with any .vcxproj file. If your .vcxproj file does not have, say, the PropertySheets import group, then you will not see any user property sheets in the Property Manager view (you might still see the system property sheets though). However, when you add a property sheet from the Property Manager view, then VS will create one such labeled import group for you at the right place in the .vcxproj file and add the import for the new property sheet. If however, your .vcxproj has a layout very different from the one described above, VS may not know what the right place is so it may end up creating it at an arbitrary location. In general, the heuristic used by VS IDE should work well for minor to moderate inconsistencies in the .vcxproj file layout.
  
 You may want to know how VS magically knows where to write a particular property. For example, when you set UseOfAtl property in the general property page, it gets written to Configuration property group whereas the TargetName property in the same general property page gets written to the label-less property group.  That is told to VS by the property itself. Well actually by the property schema in the property page xml file. Recall that property page xml defines the static information about a Rule and all its properties. One such piece of information is the preferred position of a Rule property in the destination file (the file where its value will be written). The preferred position is defined by taking advantage of the existence of Labels. Labels are used to distinguish the various top-level elements of the same type (such as two property groups).   Thus, a property can declare in the property page xml file, which of the property groups it would like to be housed in when the time comes for it to be defined in the project file.
  
 Finally, here is the skeletal MSBuild file that will illustrate the file layout of a property sheet (.props) file in VS2010. The functionality of the layout elements can be inferred based on the discussion above.

```xaml
 <Project ToolsVersion=“4.0“ xmlns=“http://schemas.microsoft.com/developer/msbuild/2003“>
   <ImportGroup Label=“PropertySheets“ />
   <PropertyGroup Label=“UserMacros“ />
   <PropertyGroup />
   <ItemDefinitionGroup />
   <ItemGroup />
 </Project>
```

To summarize, the ordered layout of .vcxproj and .props files comports with MSBuild sequential evaluation model. The use of Labels helps the IDE in reading element definitions from and writing them to the right location in the file.